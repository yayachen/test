<html>
<head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script src="http://connect.facebook.net/zh_TW/all.js"></script>

<script>
   // var appid='330581640432251';
   // var pageid='140282406003843';
  FB.init({
   appId: '743477432361811', // App ID
   //channelURL: '....................', // Channel File
   status: true, // check login status
   cookie: true, // enable cookies to allow the server to access the session
   oauth: false, // enable OAuth 2.0  
   xfbml: true  // parse XFBML
});

//2014/1/3 review
//FB.Canvas.setAutoResize 似乎已無法使用
//
//FB.Canvas.setAutoResize(false);
//請使用 
//FB.Canvas.setSize({ height: 1000, width: 760 });
//or
//請改用 FB.Canvas.setAutoGrow 試試
//https://developers.facebook.com/docs/reference/javascript/FB.Canvas.setAutoGrow/
//FB.Canvas.setAutoGrow();
FB.Canvas.setSize({ height: 200, width: 200 });
var pageid = '140282406003843';
 $(document).ready(function () {    //<--- 請自己引用 jquery
	
     FB.getLoginStatus(function (response) {
    	 alert(response.status);
         if (response.status != 'connected')
          	fb_login();
         	
             is_fan();
             is_fan_1();
             is_fan_2();
             is_fan_3();
             is_fan_4();
     });
 });

 function is_fan() {
     FB.api(
 {
    method: 'pages.isFan',
    page_id: '140282406003843' 

  },
  function (response) {
	 
	  /*alert(objToString(response));
	  alert(objToString(response.request_args));
	  alert(objToString(response.request_args[0]));
	  alert(objToString(response.request_args[1]));
	  alert(objToString(response.request_args[2]));
	  alert(objToString(response.request_args[3]));
	  alert(objToString(response.request_args[4]));
	  alert(objToString(response.request_args[5]));
	  alert(objToString(response.request_args[6]));*/
     if (response) {
    $("#div_fan").hide();
      } else {
    $("#div_fan").show();
  //  setTimeout("is_fan()", 1000);
      }
     }
     );
 }
 function is_fan_1() {
     FB.api(
 {
    method: 'pages.isFan',
    page_id: '101615286547831' 
  },
  function (response) {
     if (response) {
    $("#div_fan1").hide();
      } else {
    $("#div_fan1").show();
    setTimeout("is_fan()", 1000);
      }
     }
     );
 }
 function is_fan_2() {
     FB.api(
 {
    method: 'pages.isFan',
    page_id: '211279712259321' 
  },
  function (response) {
     if (response) {
    $("#div_fan2").hide();
      } else {
    $("#div_fan2").show();
    setTimeout("is_fan()", 1000);
      }
     }
     );
 }
 function is_fan_3() {
     FB.api(
 {
    method: 'pages.isFan',
    page_id: '144599215602127' 
  },
  function (response) {
     if (response) {
    $("#div_fan3").hide();
      } else {
    $("#div_fan3").show();
    setTimeout("is_fan()", 1000);
      }
     }
     );
 }
 function is_fan_4() {
	FB.api('me/likes/164709646910260', function(response) {
		 alert(objToString (response));
	        if (response.data.length == 1) {
	        	  $("#div_fan4").hide();
	        } else {
	        	  $("#div_fan4").show();
	        }
	    });
	/* FB.api({
		    method: "fql.query",
		    query: "SELECT uid FROM page_fan WHERE uid = me() AND page_id = '164709646910260'"
		},  function(response) {
				alert(response);
		        if(response){

		        	  $("#div_fan4").hide();

		        } else {

		        	 $("#div_fan4").show();

		        }
		    }
		);*/
 }
 function objToString (obj) {
	    var str = '';
	    for (var p in obj) {
	        if (obj.hasOwnProperty(p)) {
	            str += p + '::' + obj[p] + '\n';
	        }
	    }
	    return str;
	}
 function fb_login(){
     FB.login(function(response) {
     	alert(objToString(response));
         if (response.authResponse) {
             FB.api('/me', function(response) {
                 //登入成功
                 fb_userlike();
             });
         } else {
             //登入失敗
             alert('要先登入FB才可以參加此活動喔');
         }
     }, {scope: 'user_likes'});
 }

 function fb_userlike(){
     FB.api({
         method: 'fql.query',
         query: 'select uid from page_fan where page_id = ' + pageid + ' AND uid = me()'
     },function(data){
         isfan=data.length;
         if(isfan){
             //有按讚
            // fb_post();
         }else{
             alert('您還沒按讚喔!');
         }
     });
 }

</script>
</head>
<body>
<div style="width:760px; height:1660px;background:rgba(0,0,0,0.6);z-index:999;position:absolute;top:0px;left:0px;" >
  <div style="display:none;width: 351px; height: 285px; margin-left: 10px; background: #fff; margin-top: 10px; border: #333 2px solid; padding-top:5px;" id="div_fan">
<div style="width: 349px; margin-left: 0px; font-size: 14px; font-weight: bold; color: #333;">
請先加入粉絲團：
<div id="like_box" style="margin-top: 5px;"><iframe src="http://www.facebook.com/plugins/likebox.php?href=https://www.facebook.com/KK486?fref=ts&amp;width=349&amp;colorscheme=light&amp;show_faces=true&amp;stream=false&amp;header=false&amp;height=259" scrolling="no" frameborder="0" style="border: none; overflow: hidden; width: 360px; height: 259px;" allowTransparency="true"></iframe></div>
</div>
</div> 
 <div style="display:none;width: 351px; height: 285px; margin-left: 10px; background: #fff; margin-top: 10px; border: #333 2px solid; padding-top:5px;" id="div_fan1">
<div style="width: 349px; margin-left: 0px; font-size: 14px; font-weight: bold; color: #333;">
請先加入粉絲團：
<div id="like_box" style="margin-top: 5px;"><iframe src="http://www.facebook.com/plugins/likebox.php?href=https://www.facebook.com/mcdonalds.tw&amp;width=349&amp;colorscheme=light&amp;show_faces=true&amp;stream=false&amp;header=false&amp;height=259" scrolling="no" frameborder="0" style="border: none; overflow: hidden; width: 360px; height: 259px;" allowTransparency="true"></iframe></div>
</div>
</div>
<div style="display:none;width: 351px; height: 285px; margin-left: 10px; background: #fff; margin-top: 10px; border: #333 2px solid; padding-top:5px;" id="div_fan2">
<div style="width: 349px; margin-left: 0px; font-size: 14px; font-weight: bold; color: #333;">
請先加入粉絲團：
<div id="like_box" style="margin-top: 5px;"><iframe src="http://www.facebook.com/plugins/likebox.php?href=https://www.facebook.com/TaiwanApple&amp;width=349&amp;colorscheme=light&amp;show_faces=true&amp;stream=false&amp;header=false&amp;height=259" scrolling="no" frameborder="0" style="border: none; overflow: hidden; width: 360px; height: 259px;" allowTransparency="true"></iframe></div>
</div>
</div>
<div style="display:none;width: 351px; height: 285px; margin-left: 10px; background: #fff; margin-top: 10px; border: #333 2px solid; padding-top:5px;" id="div_fan3">
<div style="width: 349px; margin-left: 0px; font-size: 14px; font-weight: bold; color: #333;">
請先加入粉絲團：
<div id="like_box" style="margin-top: 5px;"><iframe src="http://www.facebook.com/plugins/likebox.php?href=https://www.facebook.com/SoniaSuiOfficialFanPage&amp;width=349&amp;colorscheme=light&amp;show_faces=true&amp;stream=false&amp;header=false&amp;height=259" scrolling="no" frameborder="0" style="border: none; overflow: hidden; width: 360px; height: 259px;" allowTransparency="true"></iframe></div>
</div>
</div>
<div style="display:none;width: 351px; height: 285px; margin-left: 10px; background: #fff; margin-top: 10px; border: #333 2px solid; padding-top:5px;" id="div_fan4">
<div style="width: 349px; margin-left: 0px; font-size: 14px; font-weight: bold; color: #333;">
請先加入粉絲團：
<div id="like_box" style="margin-top: 5px;"><iframe src="http://www.facebook.com/plugins/likebox.php?href=https://www.facebook.com/HTCTaiwan&amp;width=349&amp;colorscheme=light&amp;show_faces=true&amp;stream=false&amp;header=false&amp;height=259&amp;appId=330581640432251" scrolling="no" frameborder="0" style="border: none; overflow: hidden; width: 360px; height: 259px;" allowTransparency="true"></iframe></div>
</div>
</div>
</body>
</html>